{"ast":null,"code":"var _jsxFileName = \"/Users/is/Desktop/odo/src/App.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useReducer, useCallback, useEffect, useState, useRef } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  audioContext: null,\n  oscillator: null,\n  gainNode: null,\n  filterNode: null,\n  isPlaying: false,\n  frequency: 440,\n  filterFrequency: 1000,\n  waveform: 'sine',\n  error: null\n};\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'SET_AUDIO_CONTEXT':\n      return {\n        ...state,\n        audioContext: action.payload\n      };\n    case 'SET_OSCILLATOR':\n      return {\n        ...state,\n        oscillator: action.payload\n      };\n    case 'SET_GAIN_NODE':\n      return {\n        ...state,\n        gainNode: action.payload\n      };\n    case 'SET_FILTER_NODE':\n      return {\n        ...state,\n        filterNode: action.payload\n      };\n    case 'SET_PLAYING':\n      return {\n        ...state,\n        isPlaying: action.payload\n      };\n    case 'SET_FREQUENCY':\n      return {\n        ...state,\n        frequency: action.payload\n      };\n    case 'SET_FILTER_FREQUENCY':\n      return {\n        ...state,\n        filterFrequency: action.payload\n      };\n    case 'SET_WAVEFORM':\n      return {\n        ...state,\n        waveform: action.payload\n      };\n    case 'SET_ERROR':\n      return {\n        ...state,\n        error: action.payload\n      };\n    default:\n      return state;\n  }\n}\nconst CustomKnob = ({\n  value,\n  min,\n  max,\n  onChange,\n  baseColor,\n  indicatorColor,\n  label\n}) => {\n  _s();\n  const knobRef = useRef(null);\n  const isDraggingRef = useRef(false);\n  const startAngleRef = useRef(0);\n  const startValueRef = useRef(0);\n  const [debugAngle, setDebugAngle] = useState(0); // デバッグ用\n\n  const valueToAngle = useCallback(val => {\n    return (val - min) / (max - min) * 270 - 135;\n  }, [min, max]);\n  const angleToValue = useCallback(angle => {\n    const clampedAngle = Math.max(-135, Math.min(135, angle));\n    return min + (clampedAngle + 135) / 270 * (max - min);\n  }, [min, max]);\n  const currentAngle = useMemo(() => valueToAngle(value), [value, valueToAngle]);\n  const rotateKnob = useCallback(angle => {\n    if (knobRef.current) {\n      knobRef.current.style.transform = `rotate(${angle}deg)`;\n    }\n  }, []);\n  const handleMouseDown = useCallback(e => {\n    e.preventDefault();\n    const knobRect = knobRef.current.getBoundingClientRect();\n    const knobCenter = {\n      x: knobRect.left + knobRect.width / 2,\n      y: knobRect.top + knobRect.height / 2\n    };\n    startAngleRef.current = Math.atan2(e.clientY - knobCenter.y, e.clientX - knobCenter.x);\n    startValueRef.current = value;\n    isDraggingRef.current = true;\n  }, [value]);\n  const handleMouseMove = useCallback(e => {\n    if (!isDraggingRef.current) return;\n    const knobRect = knobRef.current.getBoundingClientRect();\n    const knobCenter = {\n      x: knobRect.left + knobRect.width / 2,\n      y: knobRect.top + knobRect.height / 2\n    };\n    const currentAngle = Math.atan2(e.clientY - knobCenter.y, e.clientX - knobCenter.x);\n    let angleDiff = (currentAngle - startAngleRef.current) * (180 / Math.PI);\n    if (angleDiff > 180) angleDiff -= 360;\n    if (angleDiff < -180) angleDiff += 360;\n    const newAngle = valueToAngle(startValueRef.current) + angleDiff;\n    const newValue = angleToValue(newAngle);\n    rotateKnob(newAngle);\n    onChange(newValue);\n    setDebugAngle(newAngle); // デバッグ用\n  }, [onChange, valueToAngle, angleToValue, rotateKnob]);\n  const handleMouseUp = useCallback(() => {\n    isDraggingRef.current = false;\n  }, []);\n  useEffect(() => {\n    const handleGlobalMouseMove = e => {\n      handleMouseMove(e);\n    };\n    const handleGlobalMouseUp = () => {\n      handleMouseUp();\n    };\n    if (isDraggingRef.current) {\n      window.addEventListener('mousemove', handleGlobalMouseMove);\n      window.addEventListener('mouseup', handleGlobalMouseUp);\n    }\n    return () => {\n      window.removeEventListener('mousemove', handleGlobalMouseMove);\n      window.removeEventListener('mouseup', handleGlobalMouseUp);\n    };\n  }, [handleMouseMove, handleMouseUp]);\n  useEffect(() => {\n    rotateKnob(currentAngle);\n  }, [currentAngle, rotateKnob]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col items-center\",\n    children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n      width: \"70\",\n      height: \"70\",\n      viewBox: \"0 0 100 100\",\n      onMouseDown: handleMouseDown,\n      className: \"cursor-pointer\",\n      children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n        cx: \"50\",\n        cy: \"50\",\n        r: \"45\",\n        fill: baseColor,\n        fillOpacity: \"0.2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n        cx: \"50\",\n        cy: \"50\",\n        r: \"40\",\n        fill: \"white\",\n        fillOpacity: \"0.6\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this), [...Array(27)].map((_, i) => /*#__PURE__*/_jsxDEV(\"line\", {\n        x1: \"50\",\n        y1: \"10\",\n        x2: \"50\",\n        y2: \"15\",\n        stroke: indicatorColor,\n        strokeWidth: \"1\",\n        transform: `rotate(${i * 10 - 135} 50 50)`,\n        opacity: i % 3 === 0 ? 0.8 : 0.3\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"g\", {\n        ref: knobRef,\n        children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n          cx: \"50\",\n          cy: \"50\",\n          r: \"3\",\n          fill: indicatorColor\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"rect\", {\n          x: \"48\",\n          y: \"10\",\n          width: \"4\",\n          height: \"20\",\n          fill: indicatorColor\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      className: `mt-2 text-xs font-semibold ${label === 'FREQUENCY' ? 'text-blue-600' : 'text-green-600'}`,\n      children: label\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"text-xs text-gray-500\",\n      children: [Math.round(debugAngle), \"\\xB0\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 5\n  }, this);\n};\n_s(CustomKnob, \"zixe+dAz8SCfztATwrLMTqU2NKw=\");\n_c = CustomKnob;\nconst WebSynth = () => {\n  _s2();\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const setupAudio = useCallback(() => {\n    if (state.audioContext) return;\n    try {\n      const context = new (window.AudioContext || window.webkitAudioContext)();\n      dispatch({\n        type: 'SET_AUDIO_CONTEXT',\n        payload: context\n      });\n      const osc = context.createOscillator();\n      const gain = context.createGain();\n      const filter = context.createBiquadFilter();\n      osc.type = state.waveform;\n      osc.frequency.setValueAtTime(state.frequency, context.currentTime);\n      gain.gain.setValueAtTime(0, context.currentTime);\n      filter.type = 'lowpass';\n      filter.frequency.setValueAtTime(state.filterFrequency, context.currentTime);\n      osc.connect(filter);\n      filter.connect(gain);\n      gain.connect(context.destination);\n      dispatch({\n        type: 'SET_OSCILLATOR',\n        payload: osc\n      });\n      dispatch({\n        type: 'SET_GAIN_NODE',\n        payload: gain\n      });\n      dispatch({\n        type: 'SET_FILTER_NODE',\n        payload: filter\n      });\n      osc.start();\n    } catch (error) {\n      dispatch({\n        type: 'SET_ERROR',\n        payload: 'Failed to setup audio: ' + error.message\n      });\n    }\n  }, [state.waveform, state.frequency, state.filterFrequency]);\n  const handlePlayStop = useCallback(() => {\n    if (!state.audioContext) {\n      setupAudio();\n      return;\n    }\n    try {\n      if (state.audioContext.state === 'suspended') {\n        state.audioContext.resume();\n      }\n      if (state.isPlaying) {\n        state.gainNode.gain.setTargetAtTime(0, state.audioContext.currentTime, 0.015);\n        dispatch({\n          type: 'SET_PLAYING',\n          payload: false\n        });\n      } else {\n        state.gainNode.gain.setTargetAtTime(0.5, state.audioContext.currentTime, 0.015);\n        dispatch({\n          type: 'SET_PLAYING',\n          payload: true\n        });\n      }\n    } catch (error) {\n      dispatch({\n        type: 'SET_ERROR',\n        payload: 'Error in audio playback: ' + error.message\n      });\n    }\n  }, [state.audioContext, state.isPlaying, state.gainNode, setupAudio]);\n  const handleFrequencyChange = useCallback(newFrequency => {\n    dispatch({\n      type: 'SET_FREQUENCY',\n      payload: newFrequency\n    });\n    if (state.oscillator && state.audioContext) {\n      state.oscillator.frequency.setValueAtTime(newFrequency, state.audioContext.currentTime);\n    }\n  }, [state.oscillator, state.audioContext]);\n  const handleFilterChange = useCallback(newFilterFrequency => {\n    dispatch({\n      type: 'SET_FILTER_FREQUENCY',\n      payload: newFilterFrequency\n    });\n    if (state.filterNode && state.audioContext) {\n      state.filterNode.frequency.setValueAtTime(newFilterFrequency, state.audioContext.currentTime);\n    }\n  }, [state.filterNode, state.audioContext]);\n  const handleWaveformChange = useCallback(e => {\n    const newWaveform = e.target.value;\n    dispatch({\n      type: 'SET_WAVEFORM',\n      payload: newWaveform\n    });\n    if (state.oscillator) {\n      state.oscillator.type = newWaveform;\n    }\n  }, [state.oscillator]);\n  const renderKey = useCallback((freq, isSharp = false) => /*#__PURE__*/_jsxDEV(\"button\", {\n    className: `${isSharp ? 'w-6 h-24 bg-gray-800 -mx-3 z-10' : 'w-10 h-32 bg-white'} \n                  rounded-b-lg focus:outline-none transition-all duration-150 ease-in-out \n                  transform hover:scale-y-105 active:scale-y-95 active:bg-gray-300 shadow-md relative`,\n    onMouseDown: () => {\n      if (!state.audioContext) setupAudio();\n      handleFrequencyChange(freq);\n      if (!state.isPlaying) handlePlayStop();\n    },\n    onMouseUp: () => {\n      if (state.isPlaying) handlePlayStop();\n    },\n    onTouchStart: () => {\n      if (!state.audioContext) setupAudio();\n      handleFrequencyChange(freq);\n      if (!state.isPlaying) handlePlayStop();\n    },\n    onTouchEnd: () => {\n      if (state.isPlaying) handlePlayStop();\n    },\n    \"aria-label\": `Play ${freq}Hz note`\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 247,\n    columnNumber: 5\n  }, this), [state.audioContext, setupAudio, handleFrequencyChange, state.isPlaying, handlePlayStop]);\n  useEffect(() => {\n    return () => {\n      if (state.oscillator) {\n        state.oscillator.stop();\n        state.oscillator.disconnect();\n      }\n      if (state.gainNode) state.gainNode.disconnect();\n      if (state.filterNode) state.filterNode.disconnect();\n      if (state.audioContext) state.audioContext.close();\n    };\n  }, [state.oscillator, state.gainNode, state.filterNode, state.audioContext]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex justify-center items-center min-h-screen bg-gray-100\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-8 bg-white rounded-3xl shadow-2xl w-full max-w-[480px] font-sans\",\n      children: [state.error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-red-500 text-white p-2 rounded mb-4\",\n        role: \"alert\",\n        children: state.error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-gray-200 p-6 rounded-2xl mb-6\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-green-300 h-24 rounded-lg flex items-center justify-center text-3xl font-mono text-gray-800 shadow-inner\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `transition-all duration-300 ${state.isPlaying ? 'scale-110' : 'scale-100'}`,\n            children: [state.waveform, \" - \", Math.round(state.frequency), \"Hz\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-4 gap-6 mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(CustomKnob, {\n          value: state.frequency,\n          min: 20,\n          max: 2000,\n          onChange: handleFrequencyChange,\n          baseColor: \"#3B82F6\",\n          indicatorColor: \"#1D4ED8\",\n          label: \"FREQUENCY\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CustomKnob, {\n          value: state.filterFrequency,\n          min: 20,\n          max: 20000,\n          onChange: handleFilterChange,\n          baseColor: \"#10B981\",\n          indicatorColor: \"#047857\",\n          label: \"FILTER\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col items-center justify-center\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: `w-16 h-16 rounded-full focus:outline-none focus:ring-2 focus:ring-orange-300 transition-all duration-300 ease-in-out \n                          transform hover:scale-110 shadow-md text-lg font-bold\n                          ${state.isPlaying ? 'bg-orange-500 text-white' : 'border-2 border-orange-300 text-orange-500'}`,\n            onClick: handlePlayStop,\n            \"aria-label\": state.isPlaying ? 'Stop playback' : 'Start playback',\n            children: state.isPlaying ? 'Stop' : 'Play'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col items-center justify-center\",\n          children: /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"bg-gray-200 text-gray-800 px-4 py-2 rounded-full focus:outline-none focus:ring-2 focus:ring-orange-300 shadow-md text-sm\",\n            value: state.waveform,\n            onChange: handleWaveformChange,\n            \"aria-label\": \"Select waveform\",\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"sine\",\n              children: \"Sine\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"square\",\n              children: \"Square\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"sawtooth\",\n              children: \"Sawtooth\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 337,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"triangle\",\n              children: \"Triangle\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 338,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 329,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative h-48 flex justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute flex\",\n          children: [renderKey(261.63), renderKey(277.18, true), renderKey(293.66), renderKey(311.13, true), renderKey(329.63), renderKey(349.23), renderKey(369.99, true), renderKey(392.00), renderKey(415.30, true), renderKey(440.00), renderKey(466.16, true), renderKey(493.88)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 284,\n    columnNumber: 5\n  }, this);\n};\n_s2(WebSynth, \"CBkgNXHqcz9klILzxHFKxu2gUfI=\");\n_c2 = WebSynth;\nexport default WebSynth;\nvar _c, _c2;\n$RefreshReg$(_c, \"CustomKnob\");\n$RefreshReg$(_c2, \"WebSynth\");","map":{"version":3,"names":["React","useReducer","useCallback","useEffect","useState","useRef","jsxDEV","_jsxDEV","initialState","audioContext","oscillator","gainNode","filterNode","isPlaying","frequency","filterFrequency","waveform","error","reducer","state","action","type","payload","CustomKnob","value","min","max","onChange","baseColor","indicatorColor","label","_s","knobRef","isDraggingRef","startAngleRef","startValueRef","debugAngle","setDebugAngle","valueToAngle","val","angleToValue","angle","clampedAngle","Math","currentAngle","useMemo","rotateKnob","current","style","transform","handleMouseDown","e","preventDefault","knobRect","getBoundingClientRect","knobCenter","x","left","width","y","top","height","atan2","clientY","clientX","handleMouseMove","angleDiff","PI","newAngle","newValue","handleMouseUp","handleGlobalMouseMove","handleGlobalMouseUp","window","addEventListener","removeEventListener","className","children","viewBox","onMouseDown","cx","cy","r","fill","fillOpacity","fileName","_jsxFileName","lineNumber","columnNumber","Array","map","_","i","x1","y1","x2","y2","stroke","strokeWidth","opacity","ref","round","_c","WebSynth","_s2","dispatch","setupAudio","context","AudioContext","webkitAudioContext","osc","createOscillator","gain","createGain","filter","createBiquadFilter","setValueAtTime","currentTime","connect","destination","start","message","handlePlayStop","resume","setTargetAtTime","handleFrequencyChange","newFrequency","handleFilterChange","newFilterFrequency","handleWaveformChange","newWaveform","target","renderKey","freq","isSharp","onMouseUp","onTouchStart","onTouchEnd","stop","disconnect","close","role","onClick","_c2","$RefreshReg$"],"sources":["/Users/is/Desktop/odo/src/App.js"],"sourcesContent":["import React, { useReducer, useCallback, useEffect, useState, useRef } from 'react';\n\nconst initialState = {\n  audioContext: null,\n  oscillator: null,\n  gainNode: null,\n  filterNode: null,\n  isPlaying: false,\n  frequency: 440,\n  filterFrequency: 1000,\n  waveform: 'sine',\n  error: null,\n};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'SET_AUDIO_CONTEXT':\n      return { ...state, audioContext: action.payload };\n    case 'SET_OSCILLATOR':\n      return { ...state, oscillator: action.payload };\n    case 'SET_GAIN_NODE':\n      return { ...state, gainNode: action.payload };\n    case 'SET_FILTER_NODE':\n      return { ...state, filterNode: action.payload };\n    case 'SET_PLAYING':\n      return { ...state, isPlaying: action.payload };\n    case 'SET_FREQUENCY':\n      return { ...state, frequency: action.payload };\n    case 'SET_FILTER_FREQUENCY':\n      return { ...state, filterFrequency: action.payload };\n    case 'SET_WAVEFORM':\n      return { ...state, waveform: action.payload };\n    case 'SET_ERROR':\n      return { ...state, error: action.payload };\n    default:\n      return state;\n  }\n}\n\nconst CustomKnob = ({ value, min, max, onChange, baseColor, indicatorColor, label }) => {\n  const knobRef = useRef(null);\n  const isDraggingRef = useRef(false);\n  const startAngleRef = useRef(0);\n  const startValueRef = useRef(0);\n\n  const [debugAngle, setDebugAngle] = useState(0); // デバッグ用\n\n  const valueToAngle = useCallback((val) => {\n    return ((val - min) / (max - min)) * 270 - 135;\n  }, [min, max]);\n\n  const angleToValue = useCallback((angle) => {\n    const clampedAngle = Math.max(-135, Math.min(135, angle));\n    return min + ((clampedAngle + 135) / 270) * (max - min);\n  }, [min, max]);\n\n  const currentAngle = useMemo(() => valueToAngle(value), [value, valueToAngle]);\n\n  const rotateKnob = useCallback((angle) => {\n    if (knobRef.current) {\n      knobRef.current.style.transform = `rotate(${angle}deg)`;\n    }\n  }, []);\n\n  const handleMouseDown = useCallback((e) => {\n    e.preventDefault();\n    const knobRect = knobRef.current.getBoundingClientRect();\n    const knobCenter = {\n      x: knobRect.left + knobRect.width / 2,\n      y: knobRect.top + knobRect.height / 2\n    };\n    startAngleRef.current = Math.atan2(e.clientY - knobCenter.y, e.clientX - knobCenter.x);\n    startValueRef.current = value;\n    isDraggingRef.current = true;\n  }, [value]);\n\n  const handleMouseMove = useCallback((e) => {\n    if (!isDraggingRef.current) return;\n\n    const knobRect = knobRef.current.getBoundingClientRect();\n    const knobCenter = {\n      x: knobRect.left + knobRect.width / 2,\n      y: knobRect.top + knobRect.height / 2\n    };\n    const currentAngle = Math.atan2(e.clientY - knobCenter.y, e.clientX - knobCenter.x);\n    let angleDiff = (currentAngle - startAngleRef.current) * (180 / Math.PI);\n    if (angleDiff > 180) angleDiff -= 360;\n    if (angleDiff < -180) angleDiff += 360;\n\n    const newAngle = valueToAngle(startValueRef.current) + angleDiff;\n    const newValue = angleToValue(newAngle);\n\n    rotateKnob(newAngle);\n    onChange(newValue);\n    setDebugAngle(newAngle); // デバッグ用\n  }, [onChange, valueToAngle, angleToValue, rotateKnob]);\n\n  const handleMouseUp = useCallback(() => {\n    isDraggingRef.current = false;\n  }, []);\n\n  useEffect(() => {\n    const handleGlobalMouseMove = (e) => {\n      handleMouseMove(e);\n    };\n\n    const handleGlobalMouseUp = () => {\n      handleMouseUp();\n    };\n\n    if (isDraggingRef.current) {\n      window.addEventListener('mousemove', handleGlobalMouseMove);\n      window.addEventListener('mouseup', handleGlobalMouseUp);\n    }\n\n    return () => {\n      window.removeEventListener('mousemove', handleGlobalMouseMove);\n      window.removeEventListener('mouseup', handleGlobalMouseUp);\n    };\n  }, [handleMouseMove, handleMouseUp]);\n\n  useEffect(() => {\n    rotateKnob(currentAngle);\n  }, [currentAngle, rotateKnob]);\n\n  return (\n    <div className=\"flex flex-col items-center\">\n      <svg\n        width=\"70\"\n        height=\"70\"\n        viewBox=\"0 0 100 100\"\n        onMouseDown={handleMouseDown}\n        className=\"cursor-pointer\"\n      >\n        <circle cx=\"50\" cy=\"50\" r=\"45\" fill={baseColor} fillOpacity=\"0.2\" />\n        <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"white\" fillOpacity=\"0.6\" />\n        {[...Array(27)].map((_, i) => (\n          <line\n            key={i}\n            x1=\"50\"\n            y1=\"10\"\n            x2=\"50\"\n            y2=\"15\"\n            stroke={indicatorColor}\n            strokeWidth=\"1\"\n            transform={`rotate(${i * 10 - 135} 50 50)`}\n            opacity={i % 3 === 0 ? 0.8 : 0.3}\n          />\n        ))}\n        <g ref={knobRef}>\n          <circle cx=\"50\" cy=\"50\" r=\"3\" fill={indicatorColor} />\n          <rect\n            x=\"48\" y=\"10\" width=\"4\" height=\"20\"\n            fill={indicatorColor}\n          />\n        </g>\n      </svg>\n      <span className={`mt-2 text-xs font-semibold ${label === 'FREQUENCY' ? 'text-blue-600' : 'text-green-600'}`}>\n        {label}\n      </span>\n      {/* デバッグ用の角度表示 */}\n      <span className=\"text-xs text-gray-500\">{Math.round(debugAngle)}°</span>\n    </div>\n  );\n};\n\nconst WebSynth = () => {\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  const setupAudio = useCallback(() => {\n    if (state.audioContext) return;\n\n    try {\n      const context = new (window.AudioContext || window.webkitAudioContext)();\n      dispatch({ type: 'SET_AUDIO_CONTEXT', payload: context });\n\n      const osc = context.createOscillator();\n      const gain = context.createGain();\n      const filter = context.createBiquadFilter();\n\n      osc.type = state.waveform;\n      osc.frequency.setValueAtTime(state.frequency, context.currentTime);\n      gain.gain.setValueAtTime(0, context.currentTime);\n      filter.type = 'lowpass';\n      filter.frequency.setValueAtTime(state.filterFrequency, context.currentTime);\n\n      osc.connect(filter);\n      filter.connect(gain);\n      gain.connect(context.destination);\n\n      dispatch({ type: 'SET_OSCILLATOR', payload: osc });\n      dispatch({ type: 'SET_GAIN_NODE', payload: gain });\n      dispatch({ type: 'SET_FILTER_NODE', payload: filter });\n\n      osc.start();\n    } catch (error) {\n      dispatch({ type: 'SET_ERROR', payload: 'Failed to setup audio: ' + error.message });\n    }\n  }, [state.waveform, state.frequency, state.filterFrequency]);\n\n  const handlePlayStop = useCallback(() => {\n    if (!state.audioContext) {\n      setupAudio();\n      return;\n    }\n\n    try {\n      if (state.audioContext.state === 'suspended') {\n        state.audioContext.resume();\n      }\n\n      if (state.isPlaying) {\n        state.gainNode.gain.setTargetAtTime(0, state.audioContext.currentTime, 0.015);\n        dispatch({ type: 'SET_PLAYING', payload: false });\n      } else {\n        state.gainNode.gain.setTargetAtTime(0.5, state.audioContext.currentTime, 0.015);\n        dispatch({ type: 'SET_PLAYING', payload: true });\n      }\n    } catch (error) {\n      dispatch({ type: 'SET_ERROR', payload: 'Error in audio playback: ' + error.message });\n    }\n  }, [state.audioContext, state.isPlaying, state.gainNode, setupAudio]);\n\n  const handleFrequencyChange = useCallback((newFrequency) => {\n    dispatch({ type: 'SET_FREQUENCY', payload: newFrequency });\n    if (state.oscillator && state.audioContext) {\n      state.oscillator.frequency.setValueAtTime(newFrequency, state.audioContext.currentTime);\n    }\n  }, [state.oscillator, state.audioContext]);\n\n  const handleFilterChange = useCallback((newFilterFrequency) => {\n    dispatch({ type: 'SET_FILTER_FREQUENCY', payload: newFilterFrequency });\n    if (state.filterNode && state.audioContext) {\n      state.filterNode.frequency.setValueAtTime(newFilterFrequency, state.audioContext.currentTime);\n    }\n  }, [state.filterNode, state.audioContext]);\n\n  const handleWaveformChange = useCallback((e) => {\n    const newWaveform = e.target.value;\n    dispatch({ type: 'SET_WAVEFORM', payload: newWaveform });\n    if (state.oscillator) {\n      state.oscillator.type = newWaveform;\n    }\n  }, [state.oscillator]);\n\n  const renderKey = useCallback((freq, isSharp = false) => (\n    <button\n      className={`${isSharp ? 'w-6 h-24 bg-gray-800 -mx-3 z-10' : 'w-10 h-32 bg-white'} \n                  rounded-b-lg focus:outline-none transition-all duration-150 ease-in-out \n                  transform hover:scale-y-105 active:scale-y-95 active:bg-gray-300 shadow-md relative`}\n      onMouseDown={() => {\n        if (!state.audioContext) setupAudio();\n        handleFrequencyChange(freq);\n        if (!state.isPlaying) handlePlayStop();\n      }}\n      onMouseUp={() => {\n        if (state.isPlaying) handlePlayStop();\n      }}\n      onTouchStart={() => {\n        if (!state.audioContext) setupAudio();\n        handleFrequencyChange(freq);\n        if (!state.isPlaying) handlePlayStop();\n      }}\n      onTouchEnd={() => {\n        if (state.isPlaying) handlePlayStop();\n      }}\n      aria-label={`Play ${freq}Hz note`}\n    />\n  ), [state.audioContext, setupAudio, handleFrequencyChange, state.isPlaying, handlePlayStop]);\n\n  useEffect(() => {\n    return () => {\n      if (state.oscillator) {\n        state.oscillator.stop();\n        state.oscillator.disconnect();\n      }\n      if (state.gainNode) state.gainNode.disconnect();\n      if (state.filterNode) state.filterNode.disconnect();\n      if (state.audioContext) state.audioContext.close();\n    };\n  }, [state.oscillator, state.gainNode, state.filterNode, state.audioContext]);\n\n  return (\n    <div className=\"flex justify-center items-center min-h-screen bg-gray-100\">\n      <div className=\"p-8 bg-white rounded-3xl shadow-2xl w-full max-w-[480px] font-sans\">\n        {state.error && (\n          <div className=\"bg-red-500 text-white p-2 rounded mb-4\" role=\"alert\">\n            {state.error}\n          </div>\n        )}\n        <div className=\"bg-gray-200 p-6 rounded-2xl mb-6\">\n          <div className=\"bg-green-300 h-24 rounded-lg flex items-center justify-center text-3xl font-mono text-gray-800 shadow-inner\">\n            <div className={`transition-all duration-300 ${state.isPlaying ? 'scale-110' : 'scale-100'}`}>\n              {state.waveform} - {Math.round(state.frequency)}Hz\n            </div>\n          </div>\n        </div>\n        <div className=\"grid grid-cols-4 gap-6 mb-6\">\n          <CustomKnob\n            value={state.frequency}\n            min={20}\n            max={2000}\n            onChange={handleFrequencyChange}\n            baseColor=\"#3B82F6\"\n            indicatorColor=\"#1D4ED8\"\n            label=\"FREQUENCY\"\n          />\n          <CustomKnob\n            value={state.filterFrequency}\n            min={20}\n            max={20000}\n            onChange={handleFilterChange}\n            baseColor=\"#10B981\"\n            indicatorColor=\"#047857\"\n            label=\"FILTER\"\n          />\n          <div className=\"flex flex-col items-center justify-center\">\n            <button\n              className={`w-16 h-16 rounded-full focus:outline-none focus:ring-2 focus:ring-orange-300 transition-all duration-300 ease-in-out \n                          transform hover:scale-110 shadow-md text-lg font-bold\n                          ${state.isPlaying ? 'bg-orange-500 text-white' : 'border-2 border-orange-300 text-orange-500'}`}\n              onClick={handlePlayStop}\n              aria-label={state.isPlaying ? 'Stop playback' : 'Start playback'}\n            >\n              {state.isPlaying ? 'Stop' : 'Play'}\n            </button>\n          </div>\n          <div className=\"flex flex-col items-center justify-center\">\n            <select\n              className=\"bg-gray-200 text-gray-800 px-4 py-2 rounded-full focus:outline-none focus:ring-2 focus:ring-orange-300 shadow-md text-sm\"\n              value={state.waveform}\n              onChange={handleWaveformChange}\n              aria-label=\"Select waveform\"\n            >\n              <option value=\"sine\">Sine</option>\n              <option value=\"square\">Square</option>\n              <option value=\"sawtooth\">Sawtooth</option>\n              <option value=\"triangle\">Triangle</option>\n            </select>\n          </div>\n        </div>\n        <div className=\"relative h-48 flex justify-center\">\n          <div className=\"absolute flex\">\n            {renderKey(261.63)}\n            {renderKey(277.18, true)}\n            {renderKey(293.66)}\n            {renderKey(311.13, true)}\n            {renderKey(329.63)}\n            {renderKey(349.23)}\n            {renderKey(369.99, true)}\n            {renderKey(392.00)}\n            {renderKey(415.30, true)}\n            {renderKey(440.00)}\n            {renderKey(466.16, true)}\n            {renderKey(493.88)}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default WebSynth;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}